<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Authentication callback ‚Äî StudioOrganize</title>
  <link rel="stylesheet" href="/assets/styles.css" />
  <link rel="icon" type="image/webp" href="/assets/img/studioorganizeFavicon.webp" />
  <meta name="robots" content="noindex" />
</head>
<body>
<header class="nav">
  <a class="brand brand--with-logo" href="/">
    <span class="brand__logo" aria-hidden="true"></span>
    <span class="sr-only">StudioOrganize</span>
  </a>
  <nav class="menu">
    <a class="menu__link menu__link--plain menu__link--icon" href="/">
      <span aria-hidden="true">üè†</span>
      <span class="sr-only">Home</span>
    </a>
    <div class="dropdown">
      <button class="dropbtn dropbtn--plain" type="button">Use Cases</button>
      <div class="dropdown-content">
        <a href="/use-cases/">All Use Cases</a>
        <a href="/use-cases/generate-ideas.html">Generate Ideas</a>
        <a href="/use-cases/screenplay.html">Screenplay Script</a>
        <a href="/use-cases/character-design.html">Character Design</a>
        <a href="/use-cases/set-design.html">Set / Production Design</a>
      </div>
    </div>
    <a class="menu__link menu__link--plain" href="https://finishthatstory.com" target="_blank" rel="noopener noreferrer">FinishThatStory.com</a>
    <div class="menu__actions">
      <button class="theme-toggle theme-toggle--icon" type="button" data-theme-toggle aria-pressed="false">
        <span class="sr-only">Toggle theme</span>
        <span class="theme-toggle__icon" aria-hidden="true" data-theme-icon>‚òÄÔ∏è</span>
      </button>
      <a class="menu__cta" href="https://studioorganize.com/supabase-test.html" data-auth-link>Sign up / Log in</a>
      <div class="dropdown" data-account-menu hidden>
        <button class="menu__cta" type="button" data-account-button>Account</button>
        <div class="dropdown-content">
          <a href="/account.html">My Creator Page</a>
          <a href="/product/personal.html">My Subscription</a>
          <a href="#" data-account-logout>Log out</a>
        </div>
      </div>
    </div>
  </nav>
</header>

<main class="section" style="max-width:720px">
  <h1 data-callback-title>Processing your sign-in‚Ä¶</h1>
  <p class="lead" data-callback-message>
    Hang tight while we finish linking your StudioOrganize account. You‚Äôll be redirected shortly.
  </p>

  <div class="card card--lg" style="margin-top:24px">
    <h2>Next steps</h2>
    <p data-callback-next>You can close this tab and head back to the StudioOrganize Creative Hub.</p>
    <div class="cta-row" style="margin-top:12px">
      <a class="btn btn-primary" data-open-workspace href="/creative-hub.html" rel="noopener">Open Creative Hub ‚Üí</a>
      <a class="btn btn-ghost" href="https://studioorganize.com/supabase-test.html">Go to the login page</a>
      <a class="btn btn-ghost" href="mailto:support@studioorganize.com?subject=StudioOrganize%20Account%20Help">Contact support</a>
    </div>
    <p class="muted" data-callback-details style="margin-top:12px"></p>
  </div>
</main>

<footer class="footer">
  <div class="footer__grid">
    <div><strong>StudioOrganize</strong></div>
    <div>
      <a href="mailto:support@studioorganize.com">support@studioorganize.com</a><br/>
      <span class="muted">¬© <span id="y"></span> StudioOrganize</span>
    </div>
  </div>
</footer>

<script>document.getElementById('y').textContent=new Date().getFullYear()</script>
  <script type="module" src="/assets/main.js"></script>
<script>
  (function(){
    const creativeHubUrl = '/creative-hub.html';
    const titleEl = document.querySelector('[data-callback-title]');
    const messageEl = document.querySelector('[data-callback-message]');
    const nextEl = document.querySelector('[data-callback-next]');
    const detailsEl = document.querySelector('[data-callback-details]');
    const hubLinks = document.querySelectorAll('[data-open-workspace]');

    const params = new URLSearchParams(window.location.search);
    const hash = window.location.hash ? window.location.hash.substring(1) : '';
    const hashParams = new URLSearchParams(hash);
    hashParams.forEach((value, key) => {
      if (!params.has(key)){
        params.set(key, value);
      }
    });

    const type = params.get('type');
    const error = params.get('error') || params.get('error_description');

    hubLinks.forEach(link => {
      link.setAttribute('href', creativeHubUrl);
    });

    if (error){
      titleEl.textContent = 'We couldn\'t finish signing you in';
      messageEl.textContent = 'Supabase reported an issue while processing your request.';
      nextEl.textContent = 'Please try logging in again. If the problem continues, contact support and include the details below.';
      detailsEl.textContent = error;
      detailsEl.style.color = '#f87171';
      return;
    }

    detailsEl.textContent = '';

    switch (type){
      case 'signup':
        titleEl.textContent = 'Email confirmed ‚Äî welcome aboard!';
        messageEl.textContent = 'Your StudioOrganize account is active. You can head over to the Creative Hub to start building scenes.';
        nextEl.textContent = 'Open the Creative Hub to continue. This tab is safe to close once it finishes loading.';
        break;
      case 'magiclink':
      case 'recovery':
        titleEl.textContent = 'You\'re ready to jump back in';
        messageEl.textContent = 'Your login link worked. We\'ll take you back to the StudioOrganize Creative Hub.';
        nextEl.textContent = 'If the page doesn\'t open automatically, use the button above to continue.';
        break;
      case 'invite':
        titleEl.textContent = 'Invitation accepted';
        messageEl.textContent = 'Your account is connected to StudioOrganize. Head to the Creative Hub to get started.';
        nextEl.textContent = 'Need anything else? Reach us at support@studioorganize.com.';
        break;
      default:
        titleEl.textContent = 'All set!';
        messageEl.textContent = 'Authentication finished successfully. We\'ll forward you to the StudioOrganize Creative Hub.';
        nextEl.textContent = 'If nothing happens within a few seconds, use the Creative Hub button above to continue.';
    }

    if (hash){
      try {
        const newUrl = window.location.origin + window.location.pathname;
        window.history.replaceState({}, document.title, newUrl);
      } catch (err){
        // ignore
      }
    }

    setTimeout(() => {
      window.location.href = creativeHubUrl;
    }, 4000);
  })();
</script>
</body>
</html>
