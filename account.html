<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Creator Apps ‚Äî StudioOrganize</title>
  <link rel="stylesheet" href="/assets/styles.css" />
  <link rel="icon" type="image/webp" href="/assets/img/studioorganizeFavicon.webp" />
</head>
<body>
<header class="nav">
  <a class="brand brand--with-logo" href="/">
    <span class="brand__logo" aria-hidden="true"></span>
    <span class="sr-only">StudioOrganize</span>
  </a>
  <nav class="menu">
    <a class="menu__link menu__link--plain menu__link--icon" href="/">
      <span aria-hidden="true">üè†</span>
      <span class="sr-only">Home</span>
    </a>
    <div class="dropdown">
      <button class="dropbtn dropbtn--plain" type="button">Use Cases</button>
      <div class="dropdown-content">
        <a href="/use-cases/">All Use Cases</a>
        <a href="/use-cases/generate-ideas.html">Generate Ideas</a>
        <a href="/use-cases/screenplay.html">Screenplay Script</a>
        <a href="/use-cases/character-design.html">Character Design</a>
        <a href="/use-cases/set-design.html">Set / Production Design</a>
      </div>
    </div>
    <a class="menu__link menu__link--plain" href="https://finishthatstory.com" target="_blank" rel="noopener noreferrer">FinishThatStory.com</a>
    <div class="menu__actions">
      <button class="theme-toggle theme-toggle--icon" type="button" data-theme-toggle aria-pressed="false">
        <span class="sr-only">Toggle theme</span>
        <span class="theme-toggle__icon" aria-hidden="true" data-theme-icon>‚òÄÔ∏è</span>
      </button>
      <a class="menu__cta" href="https://studioorganize.com/supabase-test.html" data-auth-link>Sign up / Log in</a>
      <div class="dropdown" data-account-menu hidden>
        <button class="menu__cta" type="button" data-account-button>Account</button>
        <div class="dropdown-content">
          <a href="/account.html">My Creator Page</a>
          <a href="/product/personal.html">My Subscription</a>
          <a href="#" data-account-logout>Log out</a>
        </div>
      </div>
    </div>
  </nav>
</header>

  <div class="workspace-launcher" data-workspace-launcher>
    <div class="workspace-launcher__controls">
      <div class="workspace-launcher__toggle-wrap">
        <button class="workspace-launcher__toggle" type="button" aria-expanded="false" aria-label="Workspace menu" data-workspace-toggle>
          <span class="sr-only">Workspace menu</span>
          <span class="workspace-launcher__icon" aria-hidden="true"></span>
        </button>
        <div class="workspace-launcher__chat" data-workspace-chat hidden aria-hidden="true">
          <div class="workspace-launcher__chat-bubble">
            <div class="workspace-launcher__chat-thread" data-workspace-chat-thread>
              <div class="workspace-launcher__chat-message workspace-launcher__chat-message--assistant">Hi there! Ready to build something great today?</div>
            </div>
            <div class="workspace-launcher__chat-suggestions">
              <button type="button" class="workspace-launcher__chat-chip" data-workspace-chat-suggestion data-workspace-chat-action="continue">Check my progress</button>
              <button type="button" class="workspace-launcher__chat-chip" data-workspace-chat-suggestion data-workspace-chat-action="new">Spin up something new</button>
              <button type="button" class="workspace-launcher__chat-chip" data-workspace-chat-suggestion data-workspace-chat-action="settings">How should you behave?</button>
            </div>
            <form class="workspace-launcher__chat-form" data-workspace-chat-form>
              <div class="workspace-launcher__chat-input">
                <input type="text" placeholder="Ask StudioOrganize‚Ä¶" aria-label="Ask the workspace assistant" data-workspace-chat-input />
                <button type="submit" class="workspace-launcher__chat-send" aria-label="Send chat message">
                  <span aria-hidden="true">‚û§</span>
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
      <div class="workspace-launcher__notifications" data-notifications>
        <button
          class="notifications-toggle"
          type="button"
          aria-haspopup="dialog"
          aria-expanded="false"
          aria-controls="notificationsModal"
          data-notifications-toggle
        >
          <span class="notifications-toggle__icon" aria-hidden="true">‚úâÔ∏è</span>
          <span class="notifications-toggle__badge" data-notifications-count></span>
          <span class="sr-only" data-notifications-label>Open notifications</span>
        </button>
      </div>
    </div>
    <div class="workspace-launcher__panel" data-workspace-panel aria-hidden="true" hidden tabindex="-1">
      <div class="workspace-launcher__actions">
        <button type="button" class="workspace-launcher__script" data-workspace-script>
          <span class="workspace-launcher__script-icon" aria-hidden="true">Ôºã</span>
          <span>STORY</span>
        </button>
      </div>
      <nav class="workspace-launcher__modules" aria-label="Workspace modules">
        <a class="workspace-launcher__module" href="/use-cases/screenplay-writing.html" data-label="Screenplay Writing">
          <span class="workspace-launcher__module-icon" aria-hidden="true">
            <img src="/assets/img/screenplay_writer1.webp" alt="" loading="lazy" />
          </span>
          <span class="sr-only">Screenplay Writing</span>
        </a>
        <a class="workspace-launcher__module" href="/CharacterStudio.html" data-label="Character Studio">
          <span class="workspace-launcher__module-icon" aria-hidden="true">
            <img src="/assets/img/studioorganize_mock.png" alt="" loading="lazy" />
          </span>
          <span class="sr-only">Character Studio</span>
        </a>
        <a class="workspace-launcher__module" href="/StoryboardPro.html" data-label="Storyboard Pro">
          <span class="workspace-launcher__module-icon" aria-hidden="true">
            <img src="/assets/img/studioorganize_mock.png" alt="" loading="lazy" />
          </span>
          <span class="sr-only">Storyboard Pro</span>
        </a>
        <a class="workspace-launcher__module" href="/use-cases/generate-ideas.html" data-label="Idea Generator">
          <span class="workspace-launcher__module-icon" aria-hidden="true">
            <img src="/assets/img/studioorganize_mock.png" alt="" loading="lazy" />
          </span>
          <span class="sr-only">Idea Generator</span>
        </a>
        <a class="workspace-launcher__module" href="/use-cases/set-design.html" data-label="Set Design">
          <span class="workspace-launcher__module-icon" aria-hidden="true">
            <img src="/assets/img/studioorganize_mock.png" alt="" loading="lazy" />
          </span>
          <span class="sr-only">Set Design</span>
        </a>
        <a class="workspace-launcher__module" href="/creative-hub.html" data-label="Creative Hub">
          <span class="workspace-launcher__module-icon" aria-hidden="true">
            <img src="/assets/img/studioorganize_mock.png" alt="" loading="lazy" />
          </span>
          <span class="sr-only">Creative Hub</span>
        </a>
      </nav>
    </div>
  </div>

<main class="section">
  <section class="creator-overview" aria-label="Today's studio overview">
    <div class="creator-overview__today">
      <span class="creator-overview__kicker">üìÖ Today</span>
      <h2 class="creator-overview__date" data-creator-date>Sunday, October 19</h2>
      <p class="creator-overview__time" data-creator-time>6:12 PM</p>
      <p class="creator-overview__subtitle">Stay synced with your studio rhythm.</p>
    </div>
    <div class="creator-overview__weather" aria-live="polite">
      <div class="creator-overview__weather-header">
        <span class="creator-overview__weather-icon" aria-hidden="true" data-weather-icon>üå§Ô∏è</span>
        <span class="creator-overview__temp"><span data-weather-temp>72</span>¬∞F</span>
      </div>
      <p class="creator-overview__condition" data-weather-status>Partly cloudy with steady light.</p>
      <p class="creator-overview__location" data-weather-location>Los Angeles Studio Lot</p>
      <p class="creator-overview__updated">Updated <span data-weather-updated>just now</span></p>
    </div>
    <div class="creator-overview__streak" aria-live="polite">
      <div class="creator-overview__streak-header">
        <span class="creator-overview__streak-icon" aria-hidden="true">üî•</span>
        <div>
          <p class="creator-overview__streak-title">Streak Tracker</p>
          <p class="creator-overview__streak-subtitle">Keep the creative flame going.</p>
        </div>
      </div>
      <div class="creator-overview__streak-stats">
        <span class="creator-overview__streak-count" data-streak-count>7</span>
        <span class="creator-overview__streak-label">days in a row</span>
      </div>
      <div class="creator-overview__streak-progress" role="img" aria-label="Streak progress 7 of 10 days">
        <span data-level="full"></span>
        <span data-level="full"></span>
        <span data-level="full"></span>
        <span data-level="full"></span>
        <span data-level="full"></span>
        <span data-level="full"></span>
        <span data-level="full"></span>
        <span data-level="empty"></span>
        <span data-level="empty"></span>
        <span data-level="empty"></span>
      </div>
      <p class="creator-overview__streak-note">Three more sessions unlock the Momentum badge.</p>
    </div>
  </section>

  <div class="app-menu" data-app-menu>
    <button
      class="app-menu__toggle"
      type="button"
      data-app-menu-toggle
      aria-haspopup="true"
      aria-expanded="false"
    >
      <span class="app-menu__title">Creator Apps</span>
      <span class="app-menu__subtitle">Jump into the StudioOrganize workspace that fits your next project.</span>
    </button>
    <div class="app-menu__popover" role="menu" data-app-menu-panel hidden>
      <ul class="app-menu__list">
        <li role="none">
          <a class="app-menu__item" href="https://studioorganize.com/use-cases/screenplay-writing.html" role="menuitem">
            <span class="app-menu__item-media">
              <img src="/assets/img/screenplay_writer1.webp" alt="" loading="lazy" />
            </span>
            <span class="app-menu__item-text">
              <span class="app-menu__item-title">Screenplay Writing</span>
              <span class="app-menu__item-copy">Screenplay writing workspace</span>
            </span>
          </a>
        </li>
        <li role="none">
          <a class="app-menu__item" href="/CharacterStudio.html" role="menuitem">
            <span class="app-menu__item-media">
              <img src="/assets/img/studioorganize_mock.png" alt="" loading="lazy" />
            </span>
            <span class="app-menu__item-text">
              <span class="app-menu__item-title">Character Studio</span>
              <span class="app-menu__item-copy">Character Studio workspace preview</span>
            </span>
          </a>
        </li>
        <li role="none">
          <span class="app-menu__item app-menu__item--disabled" role="menuitem" aria-disabled="true" tabindex="-1">
            <span class="app-menu__item-media">
              <img src="/assets/img/studioorganize_mock.png" alt="" loading="lazy" />
            </span>
            <span class="app-menu__item-text">
              <span class="app-menu__item-title">Set Design</span>
              <span class="app-menu__item-copy">Set design workspace placeholder</span>
            </span>
          </span>
        </li>
        <li role="none">
          <div class="app-menu__item app-menu__item--submenu" role="group" aria-label="Storyboarding">
            <div class="app-menu__item-header">
              <span class="app-menu__item-media">
                <img src="/assets/img/studioorganize_mock.png" alt="" loading="lazy" />
              </span>
              <div class="app-menu__item-text">
                <span class="app-menu__item-title">Storyboarding</span>
                <span class="app-menu__item-copy">Storyboarding workspace preview</span>
              </div>
            </div>
            <ul class="app-menu__sublist" role="menu">
              <li role="none"><a href="/use-cases/screenplay-writing.html#storyboardModeBtn" role="menuitem">Storyboard Lite</a></li>
              <li role="none"><a href="/StoryboardPro.html" role="menuitem">Storyboard Pro</a></li>
              <li role="none"><a href="/use-cases/screenplay-writing.html#timelineModeBtn" role="menuitem">Timeline Mode</a></li>
            </ul>
          </div>
        </li>
        <li role="none">
          <span class="app-menu__item app-menu__item--disabled" role="menuitem" aria-disabled="true" tabindex="-1">
            <span class="app-menu__item-media">
              <img src="/assets/img/studioorganize_mock.png" alt="" loading="lazy" />
            </span>
            <span class="app-menu__item-text">
              <span class="app-menu__item-title">Sound Design</span>
              <span class="app-menu__item-copy">Sound design workspace placeholder</span>
            </span>
          </span>
        </li>
        <li role="none">
          <span class="app-menu__item app-menu__item--disabled" role="menuitem" aria-disabled="true" tabindex="-1">
            <span class="app-menu__item-media">
              <img src="/assets/img/studioorganize_mock.png" alt="" loading="lazy" />
            </span>
            <span class="app-menu__item-text">
              <span class="app-menu__item-title">Editing Suite</span>
              <span class="app-menu__item-copy">Editing suite workspace placeholder</span>
            </span>
          </span>
        </li>
      </ul>
    </div>
  </div>

  <section class="creator-dashboard" aria-label="Creator progress dashboard">
    <div class="creator-dashboard__intro">
      <h2>Keep Your Creative Momentum</h2>
      <p class="muted">
        Celebrate the time you have invested, see your streak, and plan the next milestone for your studio practice.
      </p>
    </div>

    <section class="project-progress" aria-label="Story goal overview" data-project-progress>
      <div class="project-progress__header">
        <div>
          <h3>Story Goal Tracker</h3>
          <p class="muted">
            See the targets you set while loading scripts, compare them against your latest draft, and choose the next creative move in a single click.
          </p>
        </div>
        <button type="button" class="project-progress__refresh" data-project-progress-refresh>
          <span aria-hidden="true">‚ü≥</span>
          <span data-project-progress-refresh-label>Refresh goals</span>
        </button>
      </div>

      <p class="project-progress__empty muted" data-project-progress-empty>
        Set page, runtime, or scene goals from the Screenplay workspace to see your story progression here.
      </p>

      <div class="project-progress__table-wrap" data-project-progress-table hidden>
        <table class="project-progress__table">
          <thead>
            <tr>
              <th scope="col">Story</th>
              <th scope="col">Pages</th>
              <th scope="col">Runtime</th>
              <th scope="col">Scenes</th>
            </tr>
          </thead>
          <tbody data-project-progress-rows></tbody>
        </table>
      </div>

      <div class="project-progress__detail" data-project-detail hidden>
        <div class="project-progress__detail-header">
          <div>
            <span class="project-progress__detail-kicker">Spotlight story</span>
            <h4 data-project-detail-title>Untitled Script</h4>
            <p class="project-progress__detail-summary muted" data-project-detail-summary></p>
          </div>
        </div>
        <div class="project-progress__detail-meta">
          <span data-project-detail-updated></span>
          <span data-project-detail-characters></span>
        </div>
        <div class="project-progress__detail-grid">
          <div class="project-progress__metric" data-project-metric="pages">
            <p class="project-progress__metric-label">Pages</p>
            <p class="project-progress__metric-value">
              <span data-metric-value>0</span>
              <span data-metric-goal></span>
            </p>
            <div class="project-progress__metric-progress">
              <div class="project-progress__bar" data-metric-bar></div>
              <span class="project-progress__metric-percent" data-metric-percent></span>
            </div>
          </div>
          <div class="project-progress__metric" data-project-metric="runtime">
            <p class="project-progress__metric-label">Runtime</p>
            <p class="project-progress__metric-value">
              <span data-metric-value>0</span>
              <span data-metric-goal></span>
            </p>
            <div class="project-progress__metric-progress">
              <div class="project-progress__bar" data-metric-bar></div>
              <span class="project-progress__metric-percent" data-metric-percent></span>
            </div>
          </div>
          <div class="project-progress__metric" data-project-metric="scenes">
            <p class="project-progress__metric-label">Scenes</p>
            <p class="project-progress__metric-value">
              <span data-metric-value>0</span>
              <span data-metric-goal></span>
            </p>
            <div class="project-progress__metric-progress">
              <div class="project-progress__bar" data-metric-bar></div>
              <span class="project-progress__metric-percent" data-metric-percent></span>
            </div>
          </div>
        </div>
        <div class="project-progress__notes" data-project-note hidden>
          <h5>Latest project note</h5>
          <p data-project-note-text></p>
        </div>
        <div class="project-progress__actions" role="group" aria-label="Quick actions for the selected story">
          <button type="button" class="project-progress__action project-progress__action--primary" data-project-action="open-script">
            <span class="project-progress__action-title">Let's jump into this script</span>
            <span class="project-progress__action-copy">Open the Screenplay workspace and pick up exactly where you left off.</span>
          </button>
          <a class="project-progress__action" data-project-action="character" href="/CharacterStudio.html">
            <span class="project-progress__action-title">Develop a character</span>
            <span class="project-progress__action-copy">Shape motivations, relationships, and arcs in Character Studio.</span>
          </a>
          <a class="project-progress__action" data-project-action="set" href="/use-cases/set-design.html">
            <span class="project-progress__action-title">Plan your next set</span>
            <span class="project-progress__action-copy">Lay out props, lighting, and mood boards for the upcoming scene.</span>
          </a>
          <a class="project-progress__action" data-project-action="storyboard" href="/StoryboardPro.html">
            <span class="project-progress__action-title">Storyboard the next sequence</span>
            <span class="project-progress__action-copy">Map shot ideas and camera moves to prep your shoot.</span>
          </a>
        </div>
      </div>
    </section>

    <section class="ai-preferences" aria-label="AI assistant preferences" data-ai-preferences>
      <div class="ai-preferences__header">
        <div>
          <h3>AI Assistant Plan</h3>
          <p class="muted">
            Save how StudioOrganize AI should behave when it checks in from the workspace menu and inside Creator Hub.
          </p>
        </div>
        <p class="ai-preferences__story muted" data-ai-scope-note>
          <span data-ai-selected-copy>Selected story: <strong data-ai-story-name>your story</strong></span>
          <span data-ai-empty-copy hidden>Select a story from the Story Goal Tracker to customize the assistant.</span>
        </p>
      </div>
      <div class="ai-preferences__content">
        <div class="ai-preferences__primer">
          <h4>What happens next</h4>
          <ol>
            <li>First the assistant asks if you want to make progress on <em>your current story</em> or start something brand new.</li>
            <li>If you choose a new story, pick between a short sprint, a medium arc, or a long-form journey.</li>
            <li>Those choices are stored in Supabase so nudges, bias notes, and progress checks align with each script.</li>
          </ol>
          <p class="muted">
            Updates sync once you sign in. If you are offline, changes stay local until the next session.
          </p>
        </div>
        <form class="ai-preferences__form" data-ai-preferences-form novalidate>
          <fieldset class="ai-preferences__fieldset">
            <legend>Story focus</legend>
            <label class="ai-preferences__option">
              <input type="radio" name="ai-story-mode" value="continue" checked />
              <span>Make progress on my existing story</span>
            </label>
            <label class="ai-preferences__option">
              <input type="radio" name="ai-story-mode" value="new" />
              <span>Start a fresh story</span>
            </label>
          </fieldset>
          <fieldset class="ai-preferences__fieldset" data-ai-length-group>
            <legend>New story size</legend>
            <label class="ai-preferences__length">
              <input type="radio" name="ai-story-length" value="short" />
              <span>
                <strong>Short sprint</strong>
                <small>~15 beats to ship something fast</small>
              </span>
            </label>
            <label class="ai-preferences__length">
              <input type="radio" name="ai-story-length" value="medium" checked />
              <span>
                <strong>Medium arc</strong>
                <small>Classic three-act structure</small>
              </span>
            </label>
            <label class="ai-preferences__length">
              <input type="radio" name="ai-story-length" value="long" />
              <span>
                <strong>Long-form journey</strong>
                <small>Season-length or feature outline</small>
              </span>
            </label>
          </fieldset>
          <fieldset class="ai-preferences__fieldset">
            <legend>Coaching style</legend>
            <label class="ai-preferences__feature">
              <input type="checkbox" value="progress_nudges" data-ai-feature checked />
              <span>Send progress nudges when goals fall behind</span>
            </label>
            <label class="ai-preferences__feature">
              <input type="checkbox" value="structure_spotlight" data-ai-feature />
              <span>Highlight structure and milestone checkpoints</span>
            </label>
            <label class="ai-preferences__feature">
              <input type="checkbox" value="tone_cheerleader" data-ai-feature />
              <span>Keep the tone upbeat and encouraging</span>
            </label>
          </fieldset>
          <label class="ai-preferences__field">
            <span>Bias or voice notes</span>
            <textarea data-ai-bias rows="3" placeholder="Example: focus on emotional stakes, avoid horror beats, keep feedback direct."></textarea>
          </label>
          <div class="ai-preferences__actions">
            <button type="button" class="ai-preferences__save" data-ai-save>Save assistant plan</button>
            <p class="ai-preferences__status muted" data-ai-status></p>
          </div>
        </form>
      </div>
    </section>

    <section class="creator-challenges" aria-label="Creator challenges">
      <div class="creator-challenges__intro">
        <h3>Challenge Badges</h3>
        <p class="muted">Pick a badge to energize today's session and unlock new streak highlights.</p>
      </div>

      <div class="creator-challenges__grid" role="list">
        <button class="challenge-badge" type="button" role="listitem">
          <span class="challenge-badge__icon" aria-hidden="true">‚úçÔ∏è</span>
          <span class="challenge-badge__title">Writers Set Goals</span>
          <span class="challenge-badge__copy">Commit to 300 focused words and log the win.</span>
          <span class="challenge-badge__cta">Activate challenge</span>
        </button>

        <button class="challenge-badge" type="button" role="listitem">
          <span class="challenge-badge__icon" aria-hidden="true">üé¨</span>
          <span class="challenge-badge__title">Storyboard Sprint</span>
          <span class="challenge-badge__copy">Draft three key frames to visualize your next scene.</span>
          <span class="challenge-badge__cta">Activate challenge</span>
        </button>

        <button class="challenge-badge" type="button" role="listitem">
          <span class="challenge-badge__icon" aria-hidden="true">üéß</span>
          <span class="challenge-badge__title">Soundscape Remix</span>
          <span class="challenge-badge__copy">Layer two new audio textures into your current project.</span>
          <span class="challenge-badge__cta">Activate challenge</span>
        </button>

        <button class="challenge-badge" type="button" role="listitem">
          <span class="challenge-badge__icon" aria-hidden="true">üß©</span>
          <span class="challenge-badge__title">Prototype Playtest</span>
          <span class="challenge-badge__copy">Share a build or draft with one collaborator for feedback.</span>
          <span class="challenge-badge__cta">Activate challenge</span>
        </button>
      </div>
    </section>

    <div
      class="notifications-modal"
      id="notificationsModal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="notificationsModalTitle"
      hidden
      data-notifications-modal
    >
      <div class="notifications-modal__overlay" data-notifications-overlay></div>
      <div class="notifications-modal__dialog" role="document">
        <header class="notifications-modal__header">
          <div>
            <h3 id="notificationsModalTitle">Notifications</h3>
            <p class="muted">Review your studio alerts and nudges from the AI coach.</p>
          </div>
          <button type="button" class="notifications-modal__close" aria-label="Close notifications" data-notifications-close>
            √ó
          </button>
        </header>
        <ul class="creator-notifications__list">
          <li class="creator-notifications__item creator-notifications__item--alert" data-notification-item>
            <div class="creator-notifications__icon" aria-hidden="true">‚è∞</div>
            <div class="creator-notifications__content">
              <h4>Storyboard draft deadline passed</h4>
              <p>The "Episode 3 storyboard" milestone was due yesterday. Reschedule to keep your collaborators updated.</p>
              <button type="button" class="creator-notifications__action">Reschedule now</button>
            </div>
          </li>
          <li class="creator-notifications__item creator-notifications__item--coach" data-notification-item>
            <div class="creator-notifications__icon" aria-hidden="true">ü§ñ</div>
            <div class="creator-notifications__content">
              <h4>StudioOrganize AI Coach</h4>
              <p>"Great consistency! Want a warm-up prompt for today's writing sprint?"</p>
              <div class="creator-notifications__actions">
                <button type="button" class="creator-notifications__action">Send prompt</button>
                <button type="button" class="creator-notifications__action creator-notifications__action--ghost">Remind me later</button>
              </div>
            </div>
          </li>
          <li class="creator-notifications__item" data-notification-item>
            <div class="creator-notifications__icon" aria-hidden="true">üìå</div>
            <div class="creator-notifications__content">
              <h4>New reference board shared</h4>
              <p>Alex added a "Lighting moods" board to the Set Design workspace. Add your notes before Friday.</p>
              <button type="button" class="creator-notifications__action">Open board</button>
            </div>
          </li>
        </ul>
      </div>
    </div>

    <div class="creator-dashboard__grid">
      <div class="insight-card">
        <div class="insight-card__header">
          <h3>Snapshot</h3>
          <span class="insight-card__tag">Last 30 days</span>
        </div>
        <dl class="insight-card__stats">
          <div>
            <dt>Total Focus Hours</dt>
            <dd>42</dd>
          </div>
          <div>
            <dt>Creative Sessions</dt>
            <dd>18</dd>
          </div>
          <div>
            <dt>Completed Assets</dt>
            <dd>7</dd>
          </div>
        </dl>
        <p class="muted">You are on track to surpass last month by <strong>12%</strong>. Keep the streak alive!</p>
      </div>

      <div class="insight-card">
        <div class="insight-card__header">
          <h3>Annual Commitment Grid</h3>
          <span class="insight-card__tag">2024</span>
        </div>
        <div class="commitment-grid" role="img" aria-label="Annual creative commitment grid">
          <div class="commitment-grid__row commitment-grid__legend">
            <span>Jan</span><span>Feb</span><span>Mar</span><span>Apr</span><span>May</span><span>Jun</span><span>Jul</span><span>Aug</span><span>Sep</span><span>Oct</span><span>Nov</span><span>Dec</span>
          </div>
          <div class="commitment-grid__matrix">
            <span data-level="1"></span>
            <span data-level="2"></span>
            <span data-level="3"></span>
            <span data-level="0"></span>
            <span data-level="4"></span>
            <span data-level="1"></span>
            <span data-level="3"></span>
            <span data-level="2"></span>
            <span data-level="1"></span>
            <span data-level="4"></span>
            <span data-level="2"></span>
            <span data-level="3"></span>
            <span data-level="0"></span>
            <span data-level="1"></span>
            <span data-level="2"></span>
            <span data-level="1"></span>
            <span data-level="3"></span>
            <span data-level="4"></span>
            <span data-level="3"></span>
            <span data-level="2"></span>
            <span data-level="1"></span>
            <span data-level="0"></span>
            <span data-level="2"></span>
            <span data-level="3"></span>
            <span data-level="1"></span>
            <span data-level="4"></span>
            <span data-level="3"></span>
            <span data-level="2"></span>
            <span data-level="1"></span>
            <span data-level="0"></span>
            <span data-level="2"></span>
            <span data-level="1"></span>
            <span data-level="4"></span>
            <span data-level="3"></span>
            <span data-level="2"></span>
            <span data-level="1"></span>
            <span data-level="4"></span>
            <span data-level="3"></span>
            <span data-level="1"></span>
            <span data-level="2"></span>
            <span data-level="3"></span>
            <span data-level="0"></span>
            <span data-level="1"></span>
            <span data-level="2"></span>
            <span data-level="1"></span>
            <span data-level="4"></span>
            <span data-level="3"></span>
            <span data-level="2"></span>
            <span data-level="1"></span>
            <span data-level="0"></span>
            <span data-level="2"></span>
            <span data-level="3"></span>
            <span data-level="4"></span>
            <span data-level="3"></span>
            <span data-level="2"></span>
            <span data-level="1"></span>
          </div>
          <div class="commitment-grid__legend commitment-grid__legend--scale" aria-hidden="true">
            <span>Less</span>
            <div class="commitment-grid__scale">
              <span data-level="0"></span>
              <span data-level="1"></span>
              <span data-level="2"></span>
              <span data-level="3"></span>
              <span data-level="4"></span>
            </div>
            <span>More</span>
          </div>
        </div>
        <p class="muted">Each square celebrates a session. Darker tiles mean deeper focus days.</p>
      </div>

      <div class="insight-card">
        <div class="insight-card__header">
          <h3>Challenge: Writers Set Goals</h3>
          <span class="insight-card__tag">Try it today</span>
        </div>
        <p>
          Pick a focused writing target to keep your momentum going. Whether you are polishing a script or outlining your next
          essay, a small commitment today builds the habit.
        </p>
        <ul>
          <li>Choose a measurable goal like ‚Äúwrite 300 words today‚Äù.</li>
          <li>Block 25 minutes on your calendar to honor the session.</li>
          <li>Log the outcome in your dashboard so the streak continues.</li>
        </ul>
        <p class="muted">Share your progress with collaborators for extra accountability.</p>
      </div>

      <div class="insight-card insight-card--full">
        <div class="insight-card__header">
          <h3>Milestones &amp; Reminders</h3>
          <span class="insight-card__tag">Stay accountable</span>
        </div>
        <div class="goal-planner">
          <aside class="goal-planner__form-panel" aria-label="Add a milestone goal">
            <h4 class="goal-planner__heading">Plan a new milestone</h4>
            <p class="goal-planner__copy">Set a focus target, pick when it is due, and choose how you would like to be nudged.</p>
            <form class="goal-form" data-goal-form>
              <label class="goal-form__field">
                <span>Goal title</span>
                <input type="text" name="goal" placeholder="Finish storyboard draft" />
              </label>
              <label class="goal-form__field">
                <span>Target date</span>
                <input type="date" name="deadline" />
              </label>
              <label class="goal-form__field">
                <span>Email reminders</span>
                <select name="reminder">
                  <option value="weekly">Weekly digest</option>
                  <option value="three-days">3 days before</option>
                  <option value="day-before">Day before deadline</option>
                  <option value="off">No reminders</option>
                </select>
              </label>
              <label class="goal-form__field">
                <span>Add a note (optional)</span>
                <textarea name="note" rows="3" placeholder="Share progress with the team‚Ä¶"></textarea>
              </label>
              <button class="goal-form__submit" type="submit">Save goal</button>
            </form>
          </aside>
          <section class="goal-planner__list-panel" aria-live="polite">
            <div class="goal-list">
              <header class="goal-list__header">
                <h4>Saved goals</h4>
                <p class="muted">Track multiple milestones and update them as you progress.</p>
              </header>
              <ol class="goal-list__items" data-goal-list></ol>
              <p class="goal-list__empty" data-goal-empty hidden>You have not saved any goals yet.</p>
            </div>
          </section>
        </div>
        <p class="muted goal-form__footnote">
          Reminders will be delivered to your StudioOrganize email contact. You can manage alerts in your account settings at any time.
        </p>
      </div>
    </div>
  </section>
</main>

<footer class="footer">
  <div class="footer__grid">
    <div><strong>StudioOrganize</strong></div>
    <div>
      <a href="mailto:support@studioorganize.com">support@studioorganize.com</a><br/>
      <span class="muted">¬© <span id="y"></span> StudioOrganize</span>
    </div>
  </div>
</footer>

<script>
  (function(){
    const container = document.querySelector('[data-project-progress]');
    if (!container) return;

    const SELECT_STORAGE_KEY = 'SO_ACCOUNT_SELECTED_PROJECT';
    const LAST_PROJECT_KEY = 'SW_LAST_PROJECT_ID';
    const DB_NAME = 'sw_db_v1';
    const STORE_NAME = 'projects';
    const SCRIPT_LINES_PER_PAGE = 55;

    const metricsConfig = [
      {
        key: 'pages',
        statKey: 'pageEstimate',
        goalKey: 'pageCount',
        label: 'Pages',
        unitSingular: 'page',
        unitPlural: 'pages',
        formatValue: value => formatNumber(value),
        formatGoal: value => `${formatNumber(value)} ${value === 1 ? 'page' : 'pages'}`
      },
      {
        key: 'runtime',
        statKey: 'runtimeEstimate',
        goalKey: 'runtimeMinutes',
        label: 'Runtime',
        unitSingular: 'minute',
        unitPlural: 'minutes',
        formatValue: value => `${formatNumber(value)} min`,
        formatGoal: value => `${formatNumber(value)} ${value === 1 ? 'minute' : 'minutes'}`
      },
      {
        key: 'scenes',
        statKey: 'sceneCount',
        goalKey: 'sceneCount',
        label: 'Scenes',
        unitSingular: 'scene',
        unitPlural: 'scenes',
        formatValue: value => formatNumber(value),
        formatGoal: value => `${formatNumber(value)} ${value === 1 ? 'scene' : 'scenes'}`
      }
    ];

    const numberFormatter = new Intl.NumberFormat(undefined, { maximumFractionDigits: 0 });

    const tableWrap = container.querySelector('[data-project-progress-table]');
    const tableBody = container.querySelector('[data-project-progress-rows]');
    const emptyState = container.querySelector('[data-project-progress-empty]');
    const detail = container.querySelector('[data-project-detail]');
    const refreshButton = container.querySelector('[data-project-progress-refresh]');
    const refreshLabel = container.querySelector('[data-project-progress-refresh-label]');
    const detailTitle = detail?.querySelector('[data-project-detail-title]') ?? null;
    const detailSummary = detail?.querySelector('[data-project-detail-summary]') ?? null;
    const detailUpdated = detail?.querySelector('[data-project-detail-updated]') ?? null;
    const detailCharacters = detail?.querySelector('[data-project-detail-characters]') ?? null;
    const detailNotes = detail?.querySelector('[data-project-note]') ?? null;
    const detailNotesText = detail?.querySelector('[data-project-note-text]') ?? null;

    let projectsData = [];
    let selectedProjectId = null;
    let loading = false;

    function formatNumber(value){
      if (!Number.isFinite(value)) return '0';
      return numberFormatter.format(value);
    }

    function resolveProjectId(project){
      const id = project?.projectId ?? project?.project_id ?? project?.id;
      return id ? String(id) : '';
    }

    function parseNumericGoal(value){
      if (typeof value === 'number'){
        if (!Number.isFinite(value) || value <= 0) return null;
        return Math.round(value);
      }
      if (typeof value === 'string'){
        const parsed = Number(value);
        if (!Number.isFinite(parsed) || parsed <= 0) return null;
        return Math.round(parsed);
      }
      return null;
    }

    function normalizeProjectGoals(goals){
      const source = (goals && typeof goals === 'object') ? goals : {};
      const normalized = {
        pageCount: parseNumericGoal(source.pageCount ?? source.pages ?? source.pageGoal ?? source.goalPages),
        runtimeMinutes: parseNumericGoal(source.runtimeMinutes ?? source.runtime ?? source.lengthMinutes ?? source.length ?? source.runtimeGoal ?? source.goalRuntime),
        sceneCount: parseNumericGoal(source.sceneCount ?? source.scenes ?? source.sceneTotal ?? source.sceneGoal ?? source.goalScenes)
      };
      Object.keys(source).forEach(key => {
        if (!(key in normalized)){
          normalized[key] = source[key];
        }
      });
      return normalized;
    }

    function estimateScenePageCount(scene){
      if (!scene || !Array.isArray(scene.elements)) return 1;
      const lines = scene.elements.length || 0;
      return Math.max(1, Math.ceil(lines / SCRIPT_LINES_PER_PAGE));
    }

    function extractDate(value){
      if (!value) return null;
      if (typeof value === 'number'){
        const date = new Date(value);
        return Number.isNaN(date.getTime()) ? null : date;
      }
      if (typeof value === 'string'){
        const date = new Date(value);
        return Number.isNaN(date.getTime()) ? null : date;
      }
      return null;
    }

    function formatDate(date){
      if (!(date instanceof Date)) return '';
      return date.toLocaleDateString(undefined, { month: 'short', day: 'numeric', year: 'numeric' });
    }

    function computePercent(value, goal){
      if (!goal || goal <= 0) return null;
      if (!Number.isFinite(value)) return null;
      const ratio = value / goal;
      return {
        ratio,
        clamped: Math.max(0, Math.min(1, ratio)),
        percentLabel: Math.round(Math.max(0, ratio) * 100)
      };
    }

    function computeProjectSnapshot(project){
      const id = resolveProjectId(project);
      if (!id) return null;
      const rawTitle = typeof project?.title === 'string' ? project.title.trim() : '';
      const title = rawTitle || 'Untitled Script';
      const goals = normalizeProjectGoals(project?.settings?.goals);
      const scenes = Array.isArray(project?.scenes) ? project.scenes : [];
      const pageEstimate = scenes.reduce((total, scene) => total + estimateScenePageCount(scene), 0);
      const runtimeEstimate = pageEstimate;
      const sceneCount = scenes.length;
      const characters = Array.isArray(project?.catalogs?.characters) ? project.catalogs.characters : [];
      const charactersCount = characters.length;
      const notes = typeof project?.notes === 'string' ? project.notes.trim() : '';
      const updatedAt = extractDate(project?.updatedAt ?? project?.updated_at);
      const createdAt = extractDate(project?.createdAt ?? project?.created_at);
      const percentages = {
        pages: computePercent(pageEstimate, goals.pageCount ?? null),
        runtime: computePercent(runtimeEstimate, goals.runtimeMinutes ?? null),
        scenes: computePercent(sceneCount, goals.sceneCount ?? null)
      };
      const ratios = Object.values(percentages)
        .map(entry => entry?.ratio)
        .filter(value => typeof value === 'number' && Number.isFinite(value));
      const overall = ratios.length ? ratios.reduce((sum, value) => sum + value, 0) / ratios.length : null;
      return {
        id,
        title,
        goals,
        stats: { pageEstimate, runtimeEstimate, sceneCount, charactersCount },
        percentages,
        overall,
        updatedAt,
        createdAt,
        notes
      };
    }

    function fetchWorkspaceProjects(){
      return new Promise(resolve => {
        if (!('indexedDB' in window)){
          resolve([]);
          return;
        }
        let settled = false;
        const finish = value => {
          if (!settled){
            settled = true;
            resolve(value);
          }
        };
        const request = indexedDB.open(DB_NAME, 1);
        request.onerror = () => finish([]);
        request.onupgradeneeded = event => {
          const db = event.target.result;
          if (!db.objectStoreNames.contains(STORE_NAME)){
            db.createObjectStore(STORE_NAME, { keyPath: 'projectId' });
          }
        };
        request.onsuccess = event => {
          const db = event.target.result;
          if (!db.objectStoreNames.contains(STORE_NAME)){
            finish([]);
            try { db.close(); } catch (_error){}
            return;
          }
          const tx = db.transaction(STORE_NAME, 'readonly');
          const store = tx.objectStore(STORE_NAME);
          if (typeof store.getAll === 'function'){
            const getAll = store.getAll();
            getAll.onsuccess = () => {
              finish(Array.isArray(getAll.result) ? getAll.result : []);
            };
            getAll.onerror = () => finish([]);
          } else {
            const rows = [];
            const cursor = store.openCursor();
            cursor.onsuccess = e => {
              const cur = e.target.result;
              if (cur){
                rows.push(cur.value);
                cur.continue();
              } else {
                finish(rows);
              }
            };
            cursor.onerror = () => finish([]);
          }
          tx.oncomplete = () => {
            try { db.close(); } catch (_error){}
          };
        };
      });
    }

    function loadStoredSelection(){
      try {
        return localStorage.getItem(SELECT_STORAGE_KEY);
      } catch (_error){
        return null;
      }
    }

    function persistSelection(id){
      try {
        localStorage.setItem(SELECT_STORAGE_KEY, id);
      } catch (_error){}
    }

    function persistLastProject(id){
      try {
        localStorage.setItem(LAST_PROJECT_KEY, id);
      } catch (_error){}
    }

    function emitProjectSelection(project){
      const detail = project
        ? { projectId: project.id, projectTitle: project.title }
        : { projectId: null, projectTitle: '' };
      document.dispatchEvent(new CustomEvent('studioorganize:selected-project', { detail }));
    }

    function clearTable(){
      if (tableBody){
        tableBody.textContent = '';
      }
      if (detail){
        detail.hidden = true;
      }
    }

    function renderTable(){
      if (!tableBody) return;
      tableBody.textContent = '';
      projectsData.forEach(project => {
        const row = document.createElement('tr');
        row.className = 'project-progress__row';
        row.dataset.projectId = project.id;
        if (project.id === selectedProjectId){
          row.classList.add('is-selected');
        }

        const storyCell = document.createElement('th');
        storyCell.scope = 'row';

        const selectButton = document.createElement('button');
        selectButton.type = 'button';
        selectButton.className = 'project-progress__select';
        selectButton.dataset.projectSelect = project.id;
        selectButton.setAttribute('aria-label', `Analyze ${project.title}`);
        if (project.id === selectedProjectId){
          selectButton.setAttribute('aria-current', 'true');
        }

        const nameSpan = document.createElement('span');
        nameSpan.className = 'project-progress__story-name';
        nameSpan.textContent = project.title;

        const metaSpan = document.createElement('span');
        metaSpan.className = 'project-progress__story-meta';
        const metaParts = [];
        if (project.overall !== null){
          metaParts.push(`${Math.round(project.overall * 100)}% to goal`);
        }
        if (project.updatedAt){
          metaParts.push(`Updated ${formatDate(project.updatedAt)}`);
        } else if (project.createdAt){
          metaParts.push(`Created ${formatDate(project.createdAt)}`);
        }
        if (!metaParts.length){
          metaParts.push('Goals not set yet');
        }
        metaSpan.textContent = metaParts.join(' ‚Ä¢ ');

        selectButton.append(nameSpan, metaSpan);
        storyCell.appendChild(selectButton);
        row.appendChild(storyCell);

        metricsConfig.forEach(metric => {
          const cell = document.createElement('td');
          cell.className = 'project-progress__cell project-progress__cell--stat';

          const statWrapper = document.createElement('div');
          statWrapper.className = 'project-progress__stat';

          const valueEl = document.createElement('span');
          valueEl.className = 'project-progress__stat-value';
          const statValue = project.stats[metric.statKey];
          valueEl.textContent = metric.formatValue ? metric.formatValue(statValue) : formatNumber(statValue);
          statWrapper.appendChild(valueEl);

          const goalEl = document.createElement('span');
          goalEl.className = 'project-progress__stat-goal';
          const goalValue = project.goals[metric.goalKey];
          if (goalValue){
            const goalLabel = metric.formatGoal
              ? metric.formatGoal(goalValue)
              : `${formatNumber(goalValue)} ${goalValue === 1 ? metric.unitSingular : metric.unitPlural}`;
            goalEl.textContent = `of ${goalLabel}`;
          } else {
            goalEl.textContent = 'Goal not set';
            goalEl.classList.add('project-progress__stat-goal--missing');
          }
          statWrapper.appendChild(goalEl);

          const barRow = document.createElement('div');
          barRow.className = 'project-progress__stat-bar';

          const bar = document.createElement('div');
          bar.className = 'project-progress__bar';
          const percentData = project.percentages[metric.key];
          if (percentData && goalValue){
            bar.style.setProperty('--progress', percentData.clamped.toFixed(3));
            bar.setAttribute('role', 'progressbar');
            bar.setAttribute('aria-valuemin', '0');
            bar.setAttribute('aria-valuemax', String(goalValue));
            bar.setAttribute('aria-valuenow', String(Math.min(statValue, goalValue)));
            bar.setAttribute('aria-label', `${metric.label} goal progress`);
          } else {
            bar.style.setProperty('--progress', '0');
          }
          barRow.appendChild(bar);

          if (percentData){
            const percentLabel = document.createElement('span');
            percentLabel.className = 'project-progress__stat-percent';
            percentLabel.textContent = `${Math.round(Math.max(0, percentData.ratio) * 100)}%`;
            barRow.appendChild(percentLabel);
          }

          statWrapper.appendChild(barRow);
          cell.appendChild(statWrapper);
          row.appendChild(cell);
        });

        tableBody.appendChild(row);
      });
    }

    function updateRowSelection(){
      if (!tableBody) return;
      tableBody.querySelectorAll('.project-progress__row').forEach(row => {
        const isSelected = row.dataset.projectId === selectedProjectId;
        row.classList.toggle('is-selected', isSelected);
        const button = row.querySelector('[data-project-select]');
        if (button){
          if (isSelected){
            button.setAttribute('aria-current', 'true');
          } else {
            button.removeAttribute('aria-current');
          }
        }
      });
    }

    function updateDetailPanel(){
      if (!detail) return;
      const project = projectsData.find(item => item.id === selectedProjectId);
      if (!project){
        detail.hidden = true;
        return;
      }
      detail.hidden = false;
      if (detailTitle){
        detailTitle.textContent = project.title;
      }
      if (detailSummary){
        let summaryText = '';
        if (project.overall !== null){
          const overallPercent = Math.round(project.overall * 100);
          summaryText = `You're ${overallPercent}% of the way to the goals you set for this story.`;
          const focusEntry = metricsConfig
            .map(metric => ({ metric, percent: project.percentages[metric.key] }))
            .filter(entry => entry.percent && Number.isFinite(entry.percent.ratio))
            .sort((a, b) => a.percent.ratio - b.percent.ratio)[0];
          if (focusEntry){
            const ratio = Math.max(0, focusEntry.percent.ratio);
            if (ratio >= 1){
              summaryText += ` You've already met your ${focusEntry.metric.label.toLowerCase()} goal‚Äîconsider setting a new target.`;
            } else {
              summaryText += ` ${focusEntry.metric.label} progress is at ${Math.round(ratio * 100)}%, making it a strong next milestone.`;
            }
          }
        } else {
          summaryText = 'Add page, runtime, or scene goals in the Screenplay workspace to track this story here.';
        }
        detailSummary.textContent = summaryText;
      }
      if (detailUpdated){
        if (project.updatedAt){
          detailUpdated.textContent = `Updated ${formatDate(project.updatedAt)}`;
        } else if (project.createdAt){
          detailUpdated.textContent = `Created ${formatDate(project.createdAt)}`;
        } else {
          detailUpdated.textContent = 'Update time pending';
        }
      }
      if (detailCharacters){
        const count = project.stats.charactersCount || 0;
        detailCharacters.textContent = count > 0
          ? `${formatNumber(count)} ${count === 1 ? 'character profile' : 'character profiles'} started`
          : 'No character profiles yet';
      }
      metricsConfig.forEach(metric => {
        const metricEl = detail.querySelector(`[data-project-metric="${metric.key}"]`);
        if (!metricEl) return;
        const valueEl = metricEl.querySelector('[data-metric-value]');
        const goalEl = metricEl.querySelector('[data-metric-goal]');
        const barEl = metricEl.querySelector('[data-metric-bar]');
        const percentEl = metricEl.querySelector('[data-metric-percent]');
        const statValue = project.stats[metric.statKey];
        const goalValue = project.goals[metric.goalKey];
        if (valueEl){
          valueEl.textContent = metric.formatValue ? metric.formatValue(statValue) : formatNumber(statValue);
        }
        if (goalEl){
          if (goalValue){
            const goalLabel = metric.formatGoal
              ? metric.formatGoal(goalValue)
              : `${formatNumber(goalValue)} ${goalValue === 1 ? metric.unitSingular : metric.unitPlural}`;
            goalEl.textContent = `of ${goalLabel}`;
            goalEl.classList.remove('project-progress__stat-goal--missing');
          } else {
            goalEl.textContent = 'Goal not set';
            goalEl.classList.add('project-progress__stat-goal--missing');
          }
        }
        const percentData = project.percentages[metric.key];
        if (percentEl){
          percentEl.textContent = percentData ? `${Math.round(Math.max(0, percentData.ratio) * 100)}%` : '‚Äî';
        }
        if (barEl){
          const ratio = percentData ? Math.max(0, Math.min(1, percentData.ratio)) : 0;
          barEl.style.setProperty('--progress', ratio.toFixed(3));
          if (percentData && goalValue){
            barEl.setAttribute('role', 'progressbar');
            barEl.setAttribute('aria-valuemin', '0');
            barEl.setAttribute('aria-valuemax', String(goalValue));
            barEl.setAttribute('aria-valuenow', String(Math.min(statValue, goalValue)));
            barEl.setAttribute('aria-label', `${metric.label} goal progress`);
          } else {
            barEl.removeAttribute('role');
            barEl.removeAttribute('aria-valuemin');
            barEl.removeAttribute('aria-valuemax');
            barEl.removeAttribute('aria-valuenow');
            barEl.removeAttribute('aria-label');
          }
        }
      });
      if (detailNotes && detailNotesText){
        const snippet = project.notes ? project.notes.slice(0, 320).trim() : '';
        if (snippet){
          detailNotes.hidden = false;
          detailNotesText.textContent = project.notes.length > 320 ? `${snippet}‚Ä¶` : snippet;
        } else {
          detailNotes.hidden = true;
          detailNotesText.textContent = '';
        }
      }
    }

    function selectProject(id){
      const project = projectsData.find(item => item.id === id);
      if (!project){
        if (projectsData.length){
          const fallback = projectsData[0].id;
          if (fallback && fallback !== id){
            selectProject(fallback);
          } else if (detail){
            detail.hidden = true;
          }
        } else if (detail){
          detail.hidden = true;
        }
        emitProjectSelection(null);
        return;
      }
      selectedProjectId = project.id;
      persistSelection(project.id);
      persistLastProject(project.id);
      updateRowSelection();
      updateDetailPanel();
      emitProjectSelection(project);
    }

    function setEmptyStateMessage(){
      if (!emptyState) return;
      if (!('indexedDB' in window)){
        emptyState.textContent = 'Your browser does not support offline script storage. Open the Screenplay workspace to capture goals.';
      } else {
        emptyState.textContent = 'Set page, runtime, or scene goals from the Screenplay workspace to see your story progression here.';
      }
    }

    async function loadProjects(){
      if (loading) return;
      loading = true;
      container.dataset.projectProgressLoading = 'true';
      try {
        const raw = await fetchWorkspaceProjects();
        const deduped = [];
        const seen = new Set();
        raw.forEach(item => {
          const snapshot = computeProjectSnapshot(item);
          if (!snapshot) return;
          if (seen.has(snapshot.id)) return;
          seen.add(snapshot.id);
          deduped.push(snapshot);
        });
        deduped.sort((a, b) => {
          const aTime = (a.updatedAt && a.updatedAt.getTime()) || (a.createdAt && a.createdAt.getTime()) || 0;
          const bTime = (b.updatedAt && b.updatedAt.getTime()) || (b.createdAt && b.createdAt.getTime()) || 0;
          return bTime - aTime;
        });
        projectsData = deduped;
        if (!projectsData.length){
          if (tableWrap) tableWrap.hidden = true;
          setEmptyStateMessage();
          if (emptyState) emptyState.hidden = false;
          clearTable();
          selectedProjectId = null;
          emitProjectSelection(null);
          return;
        }
        if (emptyState) emptyState.hidden = true;
        if (tableWrap) tableWrap.hidden = false;

        const storedSelection = loadStoredSelection();
        const initialId = storedSelection && projectsData.some(item => item.id === storedSelection)
          ? storedSelection
          : (projectsData[0]?.id || null);
        selectedProjectId = initialId;
        renderTable();
        if (initialId){
          selectProject(initialId);
        } else {
          updateRowSelection();
          updateDetailPanel();
        }
      } finally {
        loading = false;
        delete container.dataset.projectProgressLoading;
      }
    }

    setEmptyStateMessage();
    loadProjects();

    if (tableBody){
      tableBody.addEventListener('click', event => {
        const button = event.target instanceof HTMLElement ? event.target.closest('[data-project-select]') : null;
        if (!button) return;
        const id = button.getAttribute('data-project-select');
        if (id){
          selectProject(id);
        }
      });
    }

    container.addEventListener('click', event => {
      const action = event.target instanceof HTMLElement ? event.target.closest('[data-project-action]') : null;
      if (!action) return;
      const project = projectsData.find(item => item.id === selectedProjectId);
      const projectId = project?.id;
      if (projectId){
        persistLastProject(projectId);
        persistSelection(projectId);
      }
      const type = action.getAttribute('data-project-action');
      if (type === 'open-script'){
        event.preventDefault();
        window.location.href = '/use-cases/screenplay-writing.html';
      }
    });

    if (refreshButton){
      refreshButton.addEventListener('click', () => {
        if (loading) return;
        refreshButton.disabled = true;
        refreshButton.classList.add('is-busy');
        if (refreshLabel){
          refreshLabel.dataset.previousLabel = refreshLabel.textContent || '';
          refreshLabel.textContent = 'Refreshing‚Ä¶';
        }
        loadProjects().finally(() => {
          refreshButton.disabled = false;
          refreshButton.classList.remove('is-busy');
          if (refreshLabel){
            const previous = refreshLabel.dataset.previousLabel || 'Refresh goals';
            refreshLabel.textContent = previous;
            delete refreshLabel.dataset.previousLabel;
          }
        });
      });
    }
  })();
</script>

<script>
  (function(){
    const section = document.querySelector('[data-ai-preferences]');
    if (!section) return;

    const form = section.querySelector('[data-ai-preferences-form]');
    const statusEl = section.querySelector('[data-ai-status]');
    let storyNameEl = section.querySelector('[data-ai-story-name]');
    const selectedCopy = section.querySelector('[data-ai-selected-copy]');
    const emptyCopy = section.querySelector('[data-ai-empty-copy]');
    const modeRadios = Array.from(section.querySelectorAll('input[name="ai-story-mode"]'));
    const lengthGroup = section.querySelector('[data-ai-length-group]');
    const lengthRadios = Array.from(section.querySelectorAll('input[name="ai-story-length"]'));
    const featureCheckboxes = Array.from(section.querySelectorAll('[data-ai-feature]'));
    const biasField = section.querySelector('[data-ai-bias]');
    const saveButton = section.querySelector('[data-ai-save]');

    const DEFAULT_PREF = {
      mode: 'continue',
      storyLength: 'medium',
      featureFlags: {
        progress_nudges: true,
        structure_spotlight: false,
        tone_cheerleader: false
      },
      biasNote: ''
    };

    let currentProjectId = null;
    let currentProjectTitle = '';
    let api = window.StudioOrganizeAI || null;
    let loading = false;
    let saving = false;
    let dirty = false;

    function getDefaultPreference(){
      if (api && typeof api.getDefaultPreference === 'function'){
        return api.getDefaultPreference();
      }
      return { ...DEFAULT_PREF };
    }

    function normalizePreference(pref){
      if (api && typeof api.normalizePreference === 'function'){
        return api.normalizePreference(pref);
      }
      const source = (pref && typeof pref === 'object') ? pref : {};
      const mode = source.mode === 'new' ? 'new' : 'continue';
      const length = typeof source.storyLength === 'string' && ['short', 'medium', 'long'].includes(source.storyLength)
        ? source.storyLength
        : 'medium';
      const flagsSource = (source.featureFlags && typeof source.featureFlags === 'object') ? source.featureFlags : {};
      return {
        mode,
        storyLength: mode === 'new' ? length : null,
        featureFlags: {
          progress_nudges: Boolean(flagsSource.progress_nudges ?? DEFAULT_PREF.featureFlags.progress_nudges),
          structure_spotlight: Boolean(flagsSource.structure_spotlight ?? DEFAULT_PREF.featureFlags.structure_spotlight),
          tone_cheerleader: Boolean(flagsSource.tone_cheerleader ?? DEFAULT_PREF.featureFlags.tone_cheerleader)
        },
        biasNote: typeof source.biasNote === 'string' ? source.biasNote : ''
      };
    }

    function getSelectedMode(){
      const checked = modeRadios.find(radio => radio.checked);
      return checked ? checked.value : 'continue';
    }

    function getSelectedLength(){
      const checked = lengthRadios.find(radio => radio.checked);
      return checked ? checked.value : 'medium';
    }

    function setStatus(message, tone = 'muted'){
      if (!statusEl) return;
      statusEl.textContent = message || '';
      if (message){
        statusEl.dataset.status = tone;
      } else {
        delete statusEl.dataset.status;
      }
    }

    function updateScopeView(){
      if (!selectedCopy || !emptyCopy) return;
      if (!currentProjectId){
        selectedCopy.hidden = true;
        emptyCopy.hidden = false;
      } else {
        selectedCopy.hidden = false;
        emptyCopy.hidden = true;
        storyNameEl = section.querySelector('[data-ai-story-name]');
        if (storyNameEl){
          storyNameEl.textContent = currentProjectTitle || 'your story';
        }
      }
    }

    function updateControlState(){
      const disableAll = !currentProjectId || loading;
      const mode = getSelectedMode();
      section.dataset.aiDisabled = disableAll ? 'true' : 'false';
      section.dataset.aiLoading = loading ? 'true' : 'false';
      section.dataset.aiSaving = saving ? 'true' : 'false';
      section.dataset.aiMode = mode;

      modeRadios.forEach(radio => {
        radio.disabled = disableAll || saving;
      });

      const disableLengths = disableAll || saving || mode !== 'new';
      lengthRadios.forEach(radio => {
        radio.disabled = disableLengths;
        const wrapper = radio.closest('.ai-preferences__length');
        if (wrapper){
          wrapper.classList.toggle('ai-preferences__length--disabled', disableLengths);
        }
      });
      if (lengthGroup){
        lengthGroup.dataset.disabled = disableLengths ? 'true' : 'false';
      }

      featureCheckboxes.forEach(box => {
        box.disabled = disableAll || saving;
      });
      if (biasField instanceof HTMLTextAreaElement){
        biasField.disabled = disableAll || saving;
      }
      if (saveButton){
        saveButton.disabled = disableAll || saving;
      }
    }

    function applyPreference(pref){
      const normalized = normalizePreference(pref || getDefaultPreference());
      const modeValue = normalized.mode === 'new' ? 'new' : 'continue';
      modeRadios.forEach(radio => {
        radio.checked = radio.value === modeValue;
      });
      const targetLength = normalized.storyLength && ['short', 'medium', 'long'].includes(normalized.storyLength)
        ? normalized.storyLength
        : 'medium';
      lengthRadios.forEach(radio => {
        radio.checked = radio.value === targetLength;
      });
      featureCheckboxes.forEach(box => {
        box.checked = Boolean(normalized.featureFlags?.[box.value]);
      });
      if (biasField instanceof HTMLTextAreaElement){
        biasField.value = normalized.biasNote || '';
      }
      dirty = false;
      section.dataset.aiDirty = 'false';
      updateControlState();
      return normalized;
    }

    function readForm(){
      const mode = getSelectedMode();
      const features = {};
      featureCheckboxes.forEach(box => {
        features[box.value] = box.checked;
      });
      const biasNote = biasField instanceof HTMLTextAreaElement ? biasField.value.trim() : '';
      return normalizePreference({
        mode,
        storyLength: mode === 'new' ? getSelectedLength() : null,
        featureFlags: features,
        biasNote
      });
    }

    function markDirty(){
      if (saving || loading) return;
      dirty = true;
      section.dataset.aiDirty = 'true';
      if (statusEl && (!statusEl.dataset.status || statusEl.dataset.status === 'success')){
        setStatus('Unsaved changes', 'warning');
      }
    }

    function ensureApi(){
      if (api) return Promise.resolve(api);
      if (window.StudioOrganizeAI){
        api = window.StudioOrganizeAI;
        return Promise.resolve(api);
      }
      return new Promise(resolve => {
        const handler = () => {
          api = window.StudioOrganizeAI || null;
          resolve(api);
        };
        window.addEventListener('studioorganize-ai-ready', handler, { once: true });
      });
    }

    async function loadPreferenceForProject(){
      const apiClient = await ensureApi();
      const fallback = getDefaultPreference();
      if (!currentProjectId){
        applyPreference(fallback);
        updateControlState();
        setStatus('Select a story from the Story Goal Tracker to customize the assistant.', 'warning');
        return;
      }
      loading = true;
      updateControlState();
      setStatus('Loading preferences‚Ä¶', 'muted');
      try {
        const result = apiClient
          ? await apiClient.loadPreference(currentProjectId)
          : { success: false, preference: fallback, source: 'default' };
        const preference = result?.preference || fallback;
        applyPreference(preference);
        if (result?.success){
          if (result.source === 'supabase'){
            setStatus('Preferences synced from your account.', 'success');
          } else if (result.source === 'local'){
            setStatus('Using locally saved plan. Sign in to sync everywhere.', 'warning');
          } else {
            setStatus('Preferences ready. Adjust anything you need.', 'muted');
          }
        } else {
          setStatus('No saved plan yet‚Äîtune the assistant and hit save.', 'muted');
        }
      } catch (error){
        console.error('Failed to load AI assistant preference', error);
        applyPreference(fallback);
        setStatus('Could not load preferences. Showing defaults instead.', 'error');
      } finally {
        loading = false;
        updateControlState();
      }
    }

    async function savePreferenceForProject(){
      if (saving || !currentProjectId) return;
      const apiClient = await ensureApi();
      if (!apiClient){
        setStatus('StudioOrganize AI is offline. Try again soon.', 'error');
        return;
      }
      saving = true;
      updateControlState();
      setStatus('Saving‚Ä¶', 'muted');
      const payload = readForm();
      try {
        const result = await apiClient.savePreference(currentProjectId, payload);
        if (result.success){
          applyPreference(result.preference);
          if (result.source === 'supabase'){
            setStatus('Assistant plan saved to your account.', 'success');
          } else {
            setStatus('Saved locally. Sign in to sync everywhere.', 'warning');
          }
        } else {
          setStatus('Unable to save preferences right now.', 'error');
        }
      } catch (error){
        console.error('Failed to save AI assistant preference', error);
        setStatus('Something went wrong while saving. Try again.', 'error');
      } finally {
        saving = false;
        updateControlState();
      }
    }

    modeRadios.forEach(radio => {
      radio.addEventListener('change', () => {
        updateControlState();
        markDirty();
      });
    });

    lengthRadios.forEach(radio => {
      radio.addEventListener('change', markDirty);
    });

    featureCheckboxes.forEach(box => {
      box.addEventListener('change', markDirty);
    });

    if (biasField instanceof HTMLTextAreaElement){
      biasField.addEventListener('input', markDirty);
    }

    if (saveButton){
      saveButton.addEventListener('click', event => {
        event.preventDefault();
        if (!currentProjectId){
          setStatus('Select a story from the Story Goal Tracker first.', 'warning');
          return;
        }
        savePreferenceForProject();
      });
    }

    function handleProjectSelection(detail){
      const nextId = detail && detail.projectId ? detail.projectId : null;
      const nextTitle = detail && typeof detail.projectTitle === 'string' ? detail.projectTitle : '';
      const changed = nextId !== currentProjectId;
      currentProjectId = nextId;
      currentProjectTitle = nextTitle;
      updateScopeView();
      if (!currentProjectId){
        applyPreference(getDefaultPreference());
        setStatus('Select a story from the Story Goal Tracker to customize the assistant.', 'warning');
        updateControlState();
        return;
      }
      if (changed){
        loadPreferenceForProject();
      }
    }

    document.addEventListener('studioorganize:selected-project', event => {
      handleProjectSelection(event.detail || {});
    });

    updateScopeView();
    applyPreference(getDefaultPreference());
    setStatus('Select a story from the Story Goal Tracker to customize the assistant.', 'warning');
    ensureApi();
  })();
</script>

<script>
  (function(){
    const overview = document.querySelector('.creator-overview');
    if (!overview) return;

    const now = new Date();
    const dateEl = overview.querySelector('[data-creator-date]');
    const timeEl = overview.querySelector('[data-creator-time]');
    const dateFormatter = new Intl.DateTimeFormat(undefined, { weekday: 'long', month: 'long', day: 'numeric' });
    const timeFormatter = new Intl.DateTimeFormat(undefined, { hour: 'numeric', minute: '2-digit' });

    dateEl && (dateEl.textContent = dateFormatter.format(now));
    timeEl && (timeEl.textContent = timeFormatter.format(now));

    const weather = {
      icon: 'üå§Ô∏è',
      temperature: 72,
      status: 'Partly cloudy with steady light.',
      location: 'Los Angeles Studio Lot',
      updated: now
    };

    const iconEl = overview.querySelector('[data-weather-icon]');
    const tempEl = overview.querySelector('[data-weather-temp]');
    const statusEl = overview.querySelector('[data-weather-status]');
    const locationEl = overview.querySelector('[data-weather-location]');
    const updatedEl = overview.querySelector('[data-weather-updated]');

    if (iconEl) iconEl.textContent = weather.icon;
    if (tempEl) tempEl.textContent = weather.temperature;
    if (statusEl) statusEl.textContent = weather.status;
    if (locationEl) locationEl.textContent = weather.location;
    if (updatedEl) updatedEl.textContent = 'just now';
  })();
</script>
<script>
  (function(){
    const appMenu = document.querySelector('[data-app-menu]');
    if (!appMenu) return;

    const toggle = appMenu.querySelector('[data-app-menu-toggle]');
    const panel = appMenu.querySelector('[data-app-menu-panel]');
    if (!toggle || !panel) return;

    const focusableSelectors = 'a[href], button:not([disabled])';

    function closeMenu(){
      if (panel.hidden) return;
      panel.hidden = true;
      toggle.setAttribute('aria-expanded', 'false');
      appMenu.classList.remove('app-menu--open');
    }

    function openMenu(){
      if (!panel.hidden) return;
      panel.hidden = false;
      toggle.setAttribute('aria-expanded', 'true');
      appMenu.classList.add('app-menu--open');
      const firstFocusable = panel.querySelector(focusableSelectors);
      firstFocusable?.focus();
    }

    function isOpen(){
      return toggle.getAttribute('aria-expanded') === 'true';
    }

    toggle.addEventListener('click', event => {
      event.stopPropagation();
      if (isOpen()) closeMenu();
      else openMenu();
    });

    toggle.addEventListener('keydown', event => {
      if ((event.key === 'ArrowDown' || event.key === 'Enter' || event.key === ' ') && !isOpen()){
        event.preventDefault();
        openMenu();
      }
      if (event.key === 'Escape' && isOpen()){
        event.preventDefault();
        closeMenu();
      }
    });

    panel.addEventListener('keydown', event => {
      if (event.key === 'Escape'){
        event.stopPropagation();
        closeMenu();
        toggle.focus();
      }
    });

    document.addEventListener('click', event => {
      if (!appMenu.contains(event.target)){
        closeMenu();
      }
    });

    document.addEventListener('keydown', event => {
      if (event.key === 'Escape' && isOpen()){
        closeMenu();
        toggle.focus();
      }
    });

    closeMenu();
  })();
</script>
<script>document.getElementById('y').textContent=new Date().getFullYear()</script>
<script type="module" src="/assets/main.js"></script>
</body>
</html>
